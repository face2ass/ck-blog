<%# partial('_partial/archive', {pagination: 2, index: true, type: 'index'}) %>

<%# 文章摘要列表 %>
<% page.posts.each(function(post){ %>
  <div class="article-section border rounded mb-4 shadow-sm">
    <div class="article-top">
      <%# 分类 %>
      <% if (post.categories.length){ %>
        <strong class="d-inline-block mb-2 text-primary-emphasis">
          <%- post.categories.data[post.categories.data.length - 1].name %>
        </strong>
      <% } %>
      <%# 标题 %>
      <h3 class="article-title">
        <a href="<%- url_for(post.path) %>" class="text-decoration-none link-body-emphasis">
          <%= post.title %>
        </a>
      </h3>
      <%# 日期 %>
      <div class="article-date mb-1 text-body-secondary"><%= date(post.date, 'YYYY/MM/DD') %></div>
    </div>
    <div class="article-content">
      <%# 简介 %>
      <% if (post.excerpt) { %>
        <div class="article-excerpt card-text mb-auto">
          <%- post.excerpt %>
        </div>
        <%# 封面 %>
        <% if (post.cover){ %>
          <div class="article-cover col-auto d-none d-lg-block" style="background-image: url(<%- url_for(post.cover) %>);">
          </div>
        <% } %>
      <% } else { %>
        <div class="card-text mb-auto">
          <%- post.content %>
        </div>
      <% } %>
    </div>
    <%# 进入详情按钮 %>
    <% if (theme.excerpt_link){ %>
      <a href="<%- url_for(post.path) %>#more" class="btn-more icon-link gap-1 icon-link-hover">
        继续阅读
        <svg class="bi">
          <use xlink:href="#chevron-right"></use>
        </svg>
      </a>
    <% } %>
  </div>
<% }) %>
<%# 如果页数超过1则分页 %>
<% if (page.total > 1){ %>
  <nav>
    <div class="pagination justify-content-center">
      <span class="page-item <%= page.prev ? '' : 'disabled' %>"><a class="page-link" href="/<%= page.prev_link %>">上一页</a></span>
      <% for (let i = 0;i < page.total;i++) { %>
        <span class="page-item">
          <a class="page-link <%= page.current === i + 1 ? 'active' : '' %>"
            href="<%= url_for(i === 0 ? '/' : `/page/${i + 1}`) %>"><%= i + 1 %></a>
        </span>
      <% } %>
      <span class="page-item <%= page.next ? '' : 'disabled' %>"><a class="page-link" href="/<%= page.next_link %>">下一页</a></span>
    </div>
  </nav>
<% } %>